---
import { getCollection, getEntryBySlug } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const playbooks = await getCollection('playbooks');
  return playbooks.map((playbook) => ({
    params: { slug: playbook.slug },
  }));
}

const { slug } = Astro.params;
const playbook = await getEntryBySlug('playbooks', slug);

if (!playbook) {
  throw new Response('Not found', { status: 404 });
}

const { Content } = await playbook.render();
---

<Layout>
  <a href="/playbooks" class="btn mb-4">‚Üê Back to Playbooks</a>
  <article class="max-w-3xl mx-auto space-y-6">
    <header>
      <h1 class="text-3xl font-bold">{playbook.data.title}</h1>
      <p class="mt-2 text-gray-600 dark:text-gray-300">{playbook.data.description}</p>
      <div class="mt-3 flex flex-wrap gap-2">
        {playbook.data.tags?.map((tag) => (
          <span class="pill">{tag}</span>
        ))}
      </div>
    </header>

    <div class="prose max-w-none">
      <Content />
    </div>
  </article>
</Layout>
